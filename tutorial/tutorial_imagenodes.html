



<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ImageNode &mdash; Geomapi 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
      <link rel="stylesheet" href="../_static/style.css" type="text/css" />

  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=8d563738"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="OrthoNode" href="tutorial_orthonodes.html" />
    <link rel="prev" title="LineSetNode" href="tutorial_linesetnodes.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
              <img src="../_static/geomapi_logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Information:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../information/getting%20started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../information/nodes.html">Nodes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../information/ontology.html">Ontology</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorial:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="tutorial_nodes.html">Node</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_meshnodes.html">MeshNode</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_pointcloudnodes.html">PointCloudNode</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_bimnodes.html">BIMNode</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_linesetnodes.html">LineSetNode</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">ImageNode</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#imagenode-creation">ImageNode Creation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ontology-link">Ontology link</a></li>
<li class="toctree-l3"><a class="reference internal" href="#creation-from-structure-from-motion-pipelines">Creation from Structure-from-Motion pipelines</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#capturing-reality">Capturing Reality</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#agisoft-metashape">Agisoft Metashape</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#imagenode-resource">ImageNode Resource</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#loading-the-resource">Loading The Resource</a></li>
<li class="toctree-l3"><a class="reference internal" href="#saving-the-resource">Saving The Resource</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#imagenode-transformation">ImageNode Transformation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#world-to-pixel-and-pixel-to-world">World to Pixel and Pixel to World</a></li>
<li class="toctree-l2"><a class="reference internal" href="#imagenode-visualisation">ImageNode Visualisation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#feature-detection">Feature Detection</a></li>
<li class="toctree-l2"><a class="reference internal" href="#further-reading">Further reading</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_orthonodes.html">OrthoNode</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_panonodes.html">PanoNode</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_setnodes.html">SetNode</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial_node_selection.html">Node selection</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Test Cases:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../testcases/alignmenttools.html">Alignment Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../testcases/combinationtools.html">Combination Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../testcases/site_progress.html">Construction site progress</a></li>
<li class="toctree-l1"><a class="reference internal" href="../testcases/validationtools.html">Validation Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../testcases/volume_calculation.html">Volume calculation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../geomapi/geomapi.nodes.html">geomapi.nodes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../geomapi/geomapi.utils.html">geomapi.utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="../geomapi/geomapi.tools.html">geomapi.tools</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../development/environment%20creation.html">User environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/environment%20creation.html#developer-environment">Developer environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/packaging.html">Packaging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/ontology%20creation.html">Ontology Creation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development/testcase%20creation.html">Testcase Creation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contribution</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../team/team.html">Team</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Geomapi</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">ImageNode</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/tutorial/tutorial_imagenodes.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="imagenode">
<h1>ImageNode<a class="headerlink" href="#imagenode" title="Link to this heading"></a></h1>
<p>The ImageNode class in Geomapi represents the data and metadata of image data. The data itself and methods build upon Open3D and OpenCV concepts while the metadata builds upon the RDFlib framework:</p>
<p><a class="reference external" href="https://docs.opencv.org/4.x/d3/df2/tutorial_py_basic_ops.html">https://docs.opencv.org/4.x/d3/df2/tutorial_py_basic_ops.html</a></p>
<p><a class="reference external" href="https://docs.opencv.org/4.x/d3/df2/tutorial_py_basic_ops.html">https://rdflib.readthedocs.io/</a></p>
<p>The code below shows how to create a ImageNode from various inputs.</p>
<p>First the geomapi and external packages are imported</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#IMPORT PACKAGES</span>
<span class="kn">from</span> <span class="nn">rdflib</span> <span class="kn">import</span> <span class="n">Graph</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1">#IMPORT MODULES</span>
<span class="kn">from</span> <span class="nn">context</span> <span class="kn">import</span> <span class="n">geomapi</span> <span class="c1">#context import for documentation only</span>
<span class="kn">from</span> <span class="nn">geomapi.nodes</span> <span class="kn">import</span> <span class="n">ImageNode</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Jupyter environment detected. Enabling Open3D WebVisualizer.
[Open3D INFO] WebRTC GUI backend enabled.
[Open3D INFO] WebRTCWindowSystem: HTTP handshake server disabled.
</pre></div>
</div>
</div>
</div>
<section id="imagenode-creation">
<h2>ImageNode Creation<a class="headerlink" href="#imagenode-creation" title="Link to this heading"></a></h2>
<p>A ImageNode is constructed using the same parameters as the base Node. Please refer to <a class="reference internal" href="tutorial_nodes.html"><span class="std std-doc">Node Tutorial</span></a> For more info about Node Creation</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ImageNode</span><span class="p">(</span> <span class="n">subject</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>             <span class="c1"># (URIRef, optional) : A subject to use as identifier for the Node.</span>
           <span class="n">graph</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>               <span class="c1"># (Graph, optional) : An RDF Graph to parse.</span>
           <span class="n">graphPath</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>           <span class="c1"># (Path, optional) : The path of an RDF Graph to parse.</span>
           <span class="n">name</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>                <span class="c1"># (str, optional) : A name of the Node.</span>
           <span class="n">path</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>                <span class="c1"># (Path, optional) : A filepath to a resource.</span>
           <span class="n">timestamp</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>           <span class="c1"># (str, optional) : Timestamp for the node.</span>
           <span class="n">resource</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>            <span class="c1"># (optional) : Resource associated with the node.</span>
           <span class="n">cartesianTransform</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># (np.ndarray, optional) : The (4x4) transformation matrix.</span>
           <span class="n">orientedBoundingBox</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="c1"># (o3d.geometry.OrientedBoundingBox, optional) : The oriented bounding box of the node.</span>
           <span class="n">convexHull</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>          <span class="c1"># (o3d.geometry.TriangleImage, optional) : The convex hull of the node.</span>
           <span class="n">loadResource</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>       <span class="c1"># Load the resource at initialization?</span>
           <span class="n">imageWidth</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>          <span class="c1"># (int, optional) : width of the image in pixels (u). Defaults to 640p</span>
           <span class="n">imageHeight</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>         <span class="c1"># (int, optional) : height of the image in pixels (v). Defaults to 480p</span>
           <span class="n">intrinsicMatrix</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>     <span class="c1"># (np.array, optional) : intrinsic camera matrix (3x3) k=[[fx 0 cx] [0 fy cy][0 0  1]]</span>
           <span class="n">focalLength35mm</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>     <span class="c1"># (float, optional) : focal length with a standardised Field-of-View in pixels. Defaults to circa 2600pix for a 25.4mm lens</span>
           <span class="n">keypoints</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>           <span class="c1"># (np.array, optional) : a set of image keypoints, generated through sift or orb. </span>
           <span class="n">descriptors</span> <span class="o">=</span> <span class="kc">None</span>          <span class="c1"># (np.array, optional) : a set of image descriptors, generated through sift or orb.</span>
        <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="ontology-link">
<h3>Ontology link<a class="headerlink" href="#ontology-link" title="Link to this heading"></a></h3>
<p>The ImageNode has 9 new standard properties that are serialized to the graph:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>python name</p></th>
<th class="head"><p>predicate</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">xmpPath</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">geomapi:xmpPath</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">xmlPath</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">geomapi:xmlPath</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">imageWidth</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">exif:imageWidth</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">imageHeight</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">exif:imageLength</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">principalPointU</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">geomapi:principalPointU</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">principalPointV</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">geomapi:principalPointV</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">focalLength35mm</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">geomapi:focalLength35mm</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">intrinsicMatrix</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">geomapi:intrinsicMatrix</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">depth</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">geomapi:depth</span></code></p></td>
</tr>
</tbody>
</table>
</section>
<section id="creation-from-structure-from-motion-pipelines">
<h3>Creation from Structure-from-Motion pipelines<a class="headerlink" href="#creation-from-structure-from-motion-pipelines" title="Link to this heading"></a></h3>
<p>As GEOMAPI is a geomatics API, the cartesianTransform of nodes is crucial to many of its functionality. For images, this is generally derived from Structure-from-Motion (SfM) pipelines. These pipelines allign the images in a common coordinate system of which the geospatial components are stored in software specific formats.</p>
<br>
<p>GEOMAPI currently supports two formats. <a class="reference external" href="https://www.agisoft.com/">Agisoft Metashape</a> and <a class="reference external" href="https://www.capturingreality.com/">Capturing Reality</a>.</p>
<section id="capturing-reality">
<h4>Capturing Reality<a class="headerlink" href="#capturing-reality" title="Link to this heading"></a></h4>
<p>To import the pose of an image from the Capturing Reality pipeline, one should export the coordinate information of the image to an <a class="reference external" href="https://support.capturingreality.com/hc/en-us/articles/360012410660-Coordinate-System-Preservation-with-XMPs-Full-body-Scans">XMP</a> file. These files are xml formatted and stored per image which yields cartesianTransform and some internal camera parameters such as the focalLength35mm, which is needed for digital renders.</p>
<p><img alt="rendering" src="../_images/capturingreality1.PNG" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">node</span><span class="o">=</span><span class="n">ImageNode</span><span class="p">(</span><span class="n">path</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;../../..\tests\testfiles\img\IMG_8834.jpg&quot;</span><span class="p">,</span>  <span class="n">xmpPath</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;../../..\tests\testfiles\img\IMG_8834.xmp&quot;</span><span class="p">,</span> <span class="n">depth</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">loadResource</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">focalLength35mm</span> <span class="o">=</span> <span class="mi">50</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">cartesianTransform</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">depth</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>creating camera frustrum
0.1
[[ 4.12555151e-01  4.12058430e-02 -9.10000179e-01  6.68850552e+01]
 [ 9.10841440e-01 -4.52553581e-03  4.12731621e-01  4.52551195e+01]
 [ 1.28887160e-02 -9.99140430e-01 -3.93990225e-02  5.45377093e+00]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00  1.00000000e+00]]
0.1
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="agisoft-metashape">
<h3>Agisoft Metashape<a class="headerlink" href="#agisoft-metashape" title="Link to this heading"></a></h3>
<p>Alternatively, Metashape exports its camera poses and properties in a common <a class="reference external" href="https://www.agisoft.com/forum/index.php?topic=6211.0">XML file </a>. Therefore, the xml file is used to create a list of Imagenodes using the <a class="reference internal" href="#../geomapi/geomapi.tools.html#geomapi.tools.xml_to_image_nodes"><span class="xref myst"><code class="docutils literal notranslate"><span class="pre">geomapi.tools.xml_to_image_nodes</span></code></span></a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">geomapi.tools</span> <span class="k">as</span> <span class="nn">tl</span>

<span class="n">nodes</span> <span class="o">=</span> <span class="n">tl</span><span class="o">.</span><span class="n">xml_to_image_nodes</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;../../..\tests\testfiles\img\railway.xml&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">nodes</span><span class="p">),</span> <span class="s2">&quot;nodes parsed&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;focallength35mm: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span><span class="n">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">focalLength35mm</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;intrinsic matrix </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">nodes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">intrinsicMatrix</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>191 nodes parsed
focallength35mm: 
 101.37203855665474
intrinsic matrix 
 [[2.19630446e+04 0.00000000e+00 5.82462523e+03]
 [0.00000000e+00 2.19630446e+04 4.31969922e+03]
 [0.00000000e+00 0.00000000e+00 1.00000000e+00]]
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="imagenode-resource">
<h2>ImageNode Resource<a class="headerlink" href="#imagenode-resource" title="Link to this heading"></a></h2>
<p>When creating a ImageNode with a resource, it can be done either directly with an <code class="docutils literal notranslate"><span class="pre">np.ndarray</span></code>, <code class="docutils literal notranslate"><span class="pre">PIL.Image.Image</span></code> or <code class="docutils literal notranslate"><span class="pre">o3d.geometry.Image</span></code>, or with the path to an image file.</p>
<p>A resource can be a big piece of data, this is why it is not always wanted to load the whole resource at initialization. This is why the <code class="docutils literal notranslate"><span class="pre">loadResource</span></code> parameter is default to <code class="docutils literal notranslate"><span class="pre">False</span></code></p>
<section id="loading-the-resource">
<h3>Loading The Resource<a class="headerlink" href="#loading-the-resource" title="Link to this heading"></a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">node</span> <span class="o">=</span> <span class="n">ImageNode</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;../../..\tests\testfiles\img\IMG_8834.JPG&quot;</span><span class="p">,</span> <span class="n">loadResource</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;resource before loading:&quot;</span><span class="p">,</span><span class="n">node</span><span class="o">.</span><span class="n">resource</span><span class="p">)</span>
<span class="n">node</span><span class="o">.</span><span class="n">load_resource</span><span class="p">()</span> <span class="c1"># Use specialized node fo each type of resource.</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;resource after loading:&quot;</span><span class="p">,</span><span class="n">node</span><span class="o">.</span><span class="n">resource</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Resource not loaded, but path is defined, call `load_resource()` to access it.
resource before loading: None
resource after loading: [[[ 58  63  40]
  [ 54  59  36]
  [ 51  52  34]
  ...
  [102 144 186]
  [102 144 186]
  [102 144 186]]

 [[ 58  63  40]
  [ 55  60  37]
  [ 51  52  34]
  ...
  [102 144 186]
  [102 144 186]
  [102 144 186]]

 [[ 59  64  41]
  [ 56  61  38]
  [ 52  53  35]
  ...
  [102 144 186]
  [102 144 186]
  [102 144 186]]

 ...

 [[160 159 138]
  [158 160 138]
  [158 160 138]
  ...
  [185 177 158]
  [183 175 156]
  [181 173 154]]

 [[158 160 139]
  [158 160 139]
  [158 160 139]
  ...
  [188 179 162]
  [186 177 160]
  [185 176 159]]

 [[159 161 140]
  [159 161 140]
  [158 161 140]
  ...
  [190 181 164]
  [189 180 163]
  [188 179 162]]]
</pre></div>
</div>
</div>
</div>
</section>
<section id="saving-the-resource">
<h3>Saving The Resource<a class="headerlink" href="#saving-the-resource" title="Link to this heading"></a></h3>
<p>A Image resource can be saved to disk using the <code class="docutils literal notranslate"><span class="pre">save_resource()</span></code> function.
Currently supports: .ply, .obj</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">node</span> <span class="o">=</span> <span class="n">ImageNode</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;../../..\tests\testfiles\img\IMG_8834.JPG&quot;</span><span class="p">,</span> <span class="n">loadResource</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">node</span><span class="o">.</span><span class="n">save_resource</span><span class="p">(</span><span class="n">directory</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;../../../tests/testfiles/resources&quot;</span><span class="p">,</span> <span class="n">extension</span><span class="o">=</span><span class="s2">&quot;.jpg&quot;</span><span class="p">)</span> <span class="c1"># Save the resource to the resourcePath</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="imagenode-transformation">
<h2>ImageNode Transformation<a class="headerlink" href="#imagenode-transformation" title="Link to this heading"></a></h2>
<p>Since every nod has a cartesian transform, it can be transformed using the <code class="docutils literal notranslate"><span class="pre">node.transform()</span></code> function.</p>
<p>The transformation also updates the <code class="docutils literal notranslate"><span class="pre">convexHull</span></code> and <code class="docutils literal notranslate"><span class="pre">orientedBoundingBox</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">node</span> <span class="o">=</span> <span class="n">ImageNode</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">cartesianTransform</span><span class="p">)</span>
<span class="n">transformation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">node</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">transformation</span><span class="o">=</span><span class="n">transformation</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;applying transformation: (-1)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">cartesianTransform</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">node</span> <span class="o">=</span> <span class="n">ImageNode</span><span class="p">()</span>
<span class="n">rotation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">90</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span> <span class="c1">#eulers in degrees</span>
<span class="n">node</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="n">rotation</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;applying rotation: (90,0,0)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">cartesianTransform</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">node</span> <span class="o">=</span> <span class="n">ImageNode</span><span class="p">()</span>
<span class="n">translation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">node</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">translation</span><span class="o">=</span><span class="n">translation</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;applying translation: (1,2,3)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">cartesianTransform</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[1. 0. 0. 0.]
 [0. 1. 0. 0.]
 [0. 0. 1. 0.]
 [0. 0. 0. 1.]]
applying transformation: (-1)
[[0. 0. 1. 0.]
 [0. 1. 0. 0.]
 [1. 0. 0. 0.]
 [0. 0. 0. 1.]] 

applying rotation: (90,0,0)
[[ 1.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00]
 [ 0.000000e+00  6.123234e-17 -1.000000e+00  0.000000e+00]
 [ 0.000000e+00  1.000000e+00  6.123234e-17  0.000000e+00]
 [ 0.000000e+00  0.000000e+00  0.000000e+00  1.000000e+00]] 

applying translation: (1,2,3)
[[1. 0. 0. 1.]
 [0. 1. 0. 2.]
 [0. 0. 1. 3.]
 [0. 0. 0. 1.]]
</pre></div>
</div>
</div>
</div>
</section>
<section id="world-to-pixel-and-pixel-to-world">
<h2>World to Pixel and Pixel to World<a class="headerlink" href="#world-to-pixel-and-pixel-to-world" title="Link to this heading"></a></h2>
<p>You can use the functions <a class="reference internal" href="#../geomapi/geomapi.nodes.imagenode.html#geomapi.nodes.imagenode.ImageNode.world_to_pixel_coordinates"><span class="xref myst"><code class="docutils literal notranslate"><span class="pre">geomapi.nodes.imagenode.ImageNode.world_to_pixel_coordinates</span></code></span></a> and <a class="reference internal" href="#../geomapi/geomapi.nodes.imagenode.html#geomapi.nodes.imagenode.ImageNode.pixel_to_world_coordinates"><span class="xref myst"><code class="docutils literal notranslate"><span class="pre">geomapi.nodes.imagenode.ImageNode.pixel_to_world_coordinates</span></code></span></a> to convert between the coordinate systems.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">imageNode</span> <span class="o">=</span> <span class="n">ImageNode</span><span class="p">(</span><span class="n">graphPath</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;../../../tests\testfiles\graphs\img_graph.ttl&quot;</span><span class="p">,</span>  <span class="n">subject</span> <span class="o">=</span> <span class="s2">&quot;images#IMG_8834&quot;</span><span class="p">,</span> <span class="n">loadResource</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># World to image</span>
<span class="n">wp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">200</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="o">-</span><span class="mi">50</span><span class="p">])</span>
<span class="n">uv</span><span class="p">,</span> <span class="n">depths</span> <span class="o">=</span> <span class="n">imageNode</span><span class="o">.</span><span class="n">world_to_pixel_coordinates</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">uv</span><span class="p">,</span> <span class="n">depths</span><span class="p">)</span>

<span class="c1"># Image to world</span>
<span class="n">wp_back</span> <span class="o">=</span> <span class="n">imageNode</span><span class="o">.</span><span class="n">pixel_to_world_coordinates</span><span class="p">(</span><span class="n">uv</span><span class="p">,</span> <span class="n">depths</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">wp_back</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[  50.65828383 2636.14019386]] [278.12925345]
[[-200.  -10.  -50.]]
</pre></div>
</div>
</div>
</div>
</section>
<section id="imagenode-visualisation">
<h2>ImageNode Visualisation<a class="headerlink" href="#imagenode-visualisation" title="Link to this heading"></a></h2>
<p>When a ImageNode has a resource, the <code class="docutils literal notranslate"><span class="pre">show()</span></code> function displays the Image using matplotlib.</p>
<p>Use the <code class="docutils literal notranslate"><span class="pre">convertColorspace</span></code> parameter to switch the Blue and Red channels of the image</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">node</span> <span class="o">=</span> <span class="n">ImageNode</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;../../..\tests\testfiles\img\IMG_8834.JPG&quot;</span><span class="p">,</span> <span class="n">loadResource</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">focalLength35mm</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">node</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">convertColorspace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>creating camera frustrum
1
</pre></div>
</div>
<img alt="../_images/6204ead2b76663468f13559a7259e0b91b90482a906b7a1a48cbf73d2ea62b2a.png" src="../_images/6204ead2b76663468f13559a7259e0b91b90482a906b7a1a48cbf73d2ea62b2a.png" />
</div>
</div>
<p>ImageNodes can also be shown as 3D camera frustums</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">node</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">show3d</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="feature-detection">
<h2>Feature Detection<a class="headerlink" href="#feature-detection" title="Link to this heading"></a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="n">node</span> <span class="o">=</span> <span class="n">ImageNode</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;../../..\tests\testfiles\img\IMG_8834.JPG&quot;</span><span class="p">,</span> <span class="n">loadResource</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">imageNode</span><span class="o">.</span><span class="n">get_image_features</span><span class="p">()</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">imageNode</span><span class="o">.</span><span class="n">draw_keypoints_on_image</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x2336c37a9d0&gt;
</pre></div>
</div>
<img alt="../_images/044255dda4c2c678610abb051e63106086b297e06f0dc0d69749be0594cbc716.png" src="../_images/044255dda4c2c678610abb051e63106086b297e06f0dc0d69749be0594cbc716.png" />
</div>
</div>
</section>
<section id="further-reading">
<h2>Further reading<a class="headerlink" href="#further-reading" title="Link to this heading"></a></h2>
<p>Please refer to the full <a class="reference internal" href="#../geomapi/geomapi.nodes.Imagenode.rst"><span class="xref myst">API documentation</span></a> of the ImageNode class for more details about the functionality</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="tutorial_linesetnodes.html" class="btn btn-neutral float-left" title="LineSetNode" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="tutorial_orthonodes.html" class="btn btn-neutral float-right" title="OrthoNode" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Bassier M., De Geyter S., De Winter H., Vermandere J. @ Geomatics KU Leuven.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>